<div class="col-md-12">
    <ol class="breadcrumb">
        <li class="active">应用</li>
        <li class="active">$!{appDO.appName}</li>
    </ol>
</div>
<div class="col-md-12">
    <ul id="myTab" class="nav nav-tabs">
        #if($isOnline)
            <li #if($env=="uat") class="active" #end>
                <a href="#uat" data-env="uat" data-toggle="tab">
                    预发环境
                </a>
            </li>
            <li #if($env=="online") class="active" #end>
                <a href="#online" data-env="online" data-toggle="tab">
                    线上环境
                </a>
            </li>
        #else
            <li #if($env=="dev") class="active" #end>
                <a href="#dev" data-env="dev" data-toggle="tab">
                    开发环境
                </a>
            </li>
            <li #if($env=="sit") class="active" #end>
                <a href="#sit" data-env="sit" data-toggle="tab">
                    测试环境
                </a>
            </li>
        #end
    </ul>
    <br/>
    <br/>
    <div>
        <table id="appIdEnvIpTable" class="table table-bordered">
            <thead>
            <tr>
                <th>序号</th>
                <th>IP</th>
                <th>路径</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
                #foreach($switchNode in $!switchNodeList)
                <tr>
                    <td>$velocityCount</td>
                    <td>${switchNode.nodeName}</td>
                    <td>${switchNode.allPath}</td>
                    <td style="text-align: center;">
                        <button type="button" class="btn btn-xs btn-info btn-edit launch"
                                data-nodeName="${switchNode.nodeName}|$velocityCount">展开
                        </button>
                    </td>
                </tr>
                <tr class="hide" data-nodeName="${switchNode.nodeName}|$velocityCount">
                    <td colspan="4">
                        <div>
                            <br/>
                            <table class="table table-bordered">
                                <thead>
                                <tr class="bg-success">
                                    <th>序号</th>
                                    <th>字段名</th>
                                    <th>值</th>
                                    <th>修改时间</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                    #foreach($switchData in $!switchNode.switchDataList)
                                    <tr>
                                        <td>$velocityCount</td>
                                        <td>$switchData.fieldName</td>
                                        <td>$switchData.value</td>
                                        <td>$switchData.currentDateTime</td>
                                        <td style="text-align: center">
                                            <button type="button" class="btn btn-xs btn-info btn-edit fieldChange">修改
                                            </button>
                                        </td>
                                    </tr>
                                    #end
                                </tbody>
                            </table>
                        </div>
                    </td>
                </tr>
                #end
            </tbody>
        </table>
    </div>
</div>

<script>
    $(function () {
        //tab切换事件
        $("ul#myTab").delegate("li>a", "click", function () {
            var appid = $!{appDO.appId};
            var url = "${ctxPath}/manager/managerView.htm?appId=" + appid
            var env = $(this).attr("data-env");
            if (env != undefined) {
                url = url + "&env=" + env;
            }
            window.location.href = url;
        });

        //展开事件
        $("#appIdEnvIpTable").delegate("button.launch", "click", function () {
            var appIdEnvIpPanel = $(this).parent().parent().next();
            if (appIdEnvIpPanel.hasClass("hide")) {
                appIdEnvIpPanel.removeClass("hide");
                $(this).text("关闭");
                $(this).removeClass("btn-info").addClass("btn-warning");
            } else {
                appIdEnvIpPanel.addClass("hide");
                $(this).text("展开");
                $(this).removeClass("btn-warning").addClass("btn-info");
            }
        });
    });
</script>
